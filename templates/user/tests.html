<!DOCTYPE html>
<html lang="en">
<head>
    {% load rest_framework %}{% load static %}


    <meta charset="UTF-8">
    <title>Title</title>

</head>

<body>
{{ jafar }}
{{ img }}
<form class="form" action="/api/2/?format=api " data-method="PATCH" enctype="multipart/form-data"
      class="form-horizontal" novalidate>
    {% csrf_token %}
    {% render_form serializer %}

    <div class="form-actions">

        <button type="submit">PATCH</button>

    </div>
</form>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
{#    {% block script %}#}
{#      <script>#}
{#        window.drf = {#}
{#          csrfHeaderName: "{{ csrf_header_name|default:'X-CSRFToken' }}",#}
{#          csrfToken: "{% if request %}{{ csrf_token }}{% endif %}"#}
{#        };#}
{#      </script>#}
{#<script src="{% static "rest_framework/js/jquery-3.5.1.min.js" %}"></script>#}
{#      <script src="{% static "rest_framework/js/ajax-form.js" %}"></script>#}
{#      <script src="{% static "rest_framework/js/csrf.js" %}"></script>#}
{#      <script src="{% static "rest_framework/js/bootstrap.min.js" %}"></script>#}
{#      <script src="{% static "rest_framework/js/prettify-min.js" %}"></script>#}
{#      <script src="{% static "rest_framework/js/default.js" %}"></script>#}
{#      <script>#}
{#        $(document).ready(function() {#}
{#          $('form').ajaxForm();#}
{#        });#}
{#      </script>#}
{#    {% endblock %}#}

<script>
    let name = $('.form')
    const form = document.querySelector(".form");
    const input = document.querySelector(".form input");
    const url = form.action;

    form.addEventListener('submit', e => {
        e.preventDefault()
        let file = $('input[type=file]')[0];
        let array = file.files;
        let email = $('input[type=email]');
        {#const forms = name.serialize();#}
        {#console.log(forms)#}
        let json = {'username': 2,'email': email.val(), 'profile_image': array}
         $.ajax({
            url: url,
            type: "PATCH",
            dataType: "application/json; charset=utf-8",
             headers:{
            'Content-Type' : 'application/json',
             "X-CSRFToken": input.value
        },
            data:JSON.stringify(json) ,
            success: function (data){
                console.log(data)
            }
        })








    })


</script>

</body>
</html>